<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ØµÙØ­Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ - Ø·Ù„Ø¨ CNC</title>

  <style>
    body{
      font-family: Arial, sans-serif;
      background:#f4f6f8;
      margin:0;
      padding:0;
    }
    header{
      background:#0aa06e;
      color:#fff;
      padding:18px;
      text-align:center;
      font-size:20px;
      font-weight:bold;
    }
    .container{
      max-width:900px;
      margin:auto;
      padding:15px;
    }
    .card{
      background:#fff;
      border-radius:14px;
      padding:15px;
      margin-bottom:15px;
      box-shadow:0 4px 12px rgba(0,0,0,0.08);
    }
    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .col{
      flex:1;
      min-width:150px;
    }
    label{
      display:block;
      margin:10px 0 6px;
      font-weight:bold;
      color:#333;
    }
    input, select, textarea{
      width:100%;
      padding:12px;
      border-radius:10px;
      border:1px solid #ddd;
      outline:none;
      font-size:15px;
      background:#fafafa;
    }
    textarea{
      min-height:90px;
      resize:vertical;
    }
    .btn{
      width:100%;
      padding:14px;
      border:none;
      border-radius:12px;
      font-size:17px;
      cursor:pointer;
      font-weight:bold;
      margin-top:10px;
    }
    .btn-green{ background:#0aa06e; color:#fff; }
    .btn-blue{ background:#1e88e5; color:#fff; }
    .btn-gray{ background:#444; color:#fff; }
    .btn-red{ background:#e53935; color:#fff; }
    .small-btn{
      padding:10px 12px;
      border-radius:10px;
      border:none;
      cursor:pointer;
      font-weight:bold;
      font-size:14px;
    }
    .small-red{ background:#e53935; color:#fff; }
    .small-blue{ background:#1e88e5; color:#fff; }

    .topbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
    }
    .welcome{
      font-size:16px;
      color:#222;
      font-weight:bold;
    }
    .statusBox{
      padding:10px 12px;
      border-radius:12px;
      background:#f1f5f9;
      border:1px solid #e2e8f0;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .badge{
      padding:6px 10px;
      border-radius:999px;
      font-weight:bold;
      font-size:14px;
      display:inline-block;
    }
    .badge-wip{ background:#fff3cd; color:#856404; border:1px solid #ffeeba; }
    .badge-done{ background:#d4edda; color:#155724; border:1px solid #c3e6cb; }

    .sheetRow{
      border:1px solid #e5e7eb;
      border-radius:12px;
      padding:10px;
      margin-top:10px;
      background:#fcfcfc;
    }
    .sheetRowHeader{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      margin-bottom:8px;
    }
    .hint{
      color:#666;
      font-size:13px;
      margin-top:8px;
      line-height:1.6;
    }
    .divider{
      height:1px;
      background:#eee;
      margin:15px 0;
    }
  </style>
</head>

<body>

  <header>ØµÙØ­Ø© Ø§Ù„Ø¹Ù…ÙŠÙ„ (Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ CNC)</header>

  <div class="container">

    <!-- Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© -->
    <div class="card">
      <div class="topbar">
        <div class="welcome" id="welcomeText">Ù…Ø±Ø­Ø¨Ø§Ù‹ ğŸ‘‹</div>
        <button class="small-btn btn-gray" onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
      </div>

      <div style="margin-top:12px" class="statusBox">
        <div>
          <div style="font-weight:bold; margin-bottom:4px;">Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
          <span class="badge badge-wip" id="orderStatusBadge">â³ Ù‚ÙŠØ¯ Ø§Ù„ØªØ´ØºÙŠÙ„</span>
        </div>

        <div style="min-width:220px;">
          <label style="margin:0 0 6px;">ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø© (ØªØ¬Ø±ÙŠØ¨ÙŠ)</label>
          <select id="statusSelect" onchange="changeStatus()">
            <option value="wip">Ù‚ÙŠØ¯ Ø§Ù„ØªØ´ØºÙŠÙ„</option>
            <option value="done">Ø¬Ø§Ù‡Ø² Ø§Ù„Ø·Ù„Ø¨ âœ…</option>
          </select>
        </div>
      </div>

      <div class="hint">
        âœ… Ù‡Ø°Ù‡ ØµÙØ­Ø© Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.<br>
        ğŸ“Œ Ù„Ø§ Ù†Ø­ØªØ§Ø¬ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù„Ø£Ù† Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…Ø­ÙÙˆØ¸.
      </div>
    </div>

    <!-- Ù‚Ø³Ù… 1: Ø·Ù„Ø¨ Ø§Ù„Ø´ÙŠØª Ù„Ù„Ù…ÙˆØ±Ø¯ -->
    <div class="card">
      <h3 style="margin:0 0 10px;">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø´ÙŠØª (Ù„Ù„Ø´Ø±Ø§Ø¡ Ù…Ù† Ø§Ù„Ù…ÙˆØ±Ø¯)</h3>
      <div class="hint">Ø§ÙƒØªØ¨ Ù‚ÙŠØ§Ø³ Ø§Ù„Ø´ÙŠØª + Ø§Ù„Ø³Ù…Ø§ÙƒØ© + Ø§Ù„ÙƒÙ…ÙŠØ©ØŒ ÙˆØªÙ‚Ø¯Ø± ØªØ¶ÙŠÙ Ø£ÙƒØ«Ø± Ù…Ù† Ø´ÙŠØª.</div>

      <label>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…ÙˆØ±Ø¯</label>
      <select id="supplierSelect">
        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ±Ø¯</option>
        <option value="96590000000">Ù…ÙˆØ±Ø¯ 1 (Ù…Ø«Ø§Ù„)</option>
        <option value="96591111111">Ù…ÙˆØ±Ø¯ 2 (Ù…Ø«Ø§Ù„)</option>
        <option value="96592222222">Ù…ÙˆØ±Ø¯ 3 (Ù…Ø«Ø§Ù„)</option>
      </select>

      <div id="sheetsContainer"></div>

      <button class="btn btn-blue" onclick="addSheetRow()">+ Ø¥Ø¶Ø§ÙØ© Ø´ÙŠØª</button>

      <button class="btn btn-green" onclick="sendSheetsToSupplier()">
        ğŸ“© Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø´ÙŠØª Ù„Ù„Ù…ÙˆØ±Ø¯ (ÙˆØ§ØªØ³Ø§Ø¨)
      </button>

      <div class="hint">
        ğŸ”¹ Ø³ÙŠØ·Ù„Ø¹ Ù„Ùƒ Ù†Øµ Ø¬Ø§Ù‡Ø² Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨ ÙÙŠÙ‡ Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ + ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø´ÙŠØª ÙÙ‚Ø·.
      </div>
    </div>

    <!-- Ù‚Ø³Ù… 2: Ø·Ù„Ø¨ CNC Ù„Ù„Ù…ØµÙ†Ø¹ -->
    <div class="card">
      <h3 style="margin:0 0 10px;">Ø·Ù„Ø¨ CNC Ù„Ù„Ù…ØµÙ†Ø¹</h3>

      <label>Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨</label>
      <select id="orderType">
        <option value="Ù‚Øµ ÙÙ‚Ø·">Ù‚Øµ ÙÙ‚Ø·</option>
        <option value="Ø­ÙØ± ÙÙ‚Ø·">Ø­ÙØ± ÙÙ‚Ø·</option>
        <option value="Ù‚Øµ + Ø­ÙØ±">Ù‚Øµ + Ø­ÙØ±</option>
      </select>

      <div class="row">
        <div class="col">
          <label>Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø· / Ø§Ù„Ø³Ù…Ø§ÙƒØ© (mm)</label>
          <select id="lineWidth">
            <option value="">Ø§Ø®ØªØ±</option>
            <option value="1">1</option>
            <option value="1.5">1.5</option>
            <option value="2">2</option>
            <option value="2.5">2.5</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="8">8</option>
            <option value="10">10</option>
          </select>
        </div>

        <div class="col">
          <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø§Ø¯Ø©</label>
          <select id="materialType">
            <option value="Ø£Ù„Ù…Ù†ÙŠÙˆÙ…">Ø£Ù„Ù…Ù†ÙŠÙˆÙ…</option>
            <option value="Ø³ØªØ§Ù†Ù„Ø³">Ø³ØªØ§Ù†Ù„Ø³</option>
            <option value="Ø­Ø¯ÙŠØ¯">Ø­Ø¯ÙŠØ¯</option>
            <option value="Ø£Ù„ÙƒÙˆØ¨ÙˆÙ†Ø¯">Ø£Ù„ÙƒÙˆØ¨ÙˆÙ†Ø¯</option>
          </select>
        </div>
      </div>

      <label>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‚Øµ / Ø§Ù„Ø­ÙØ±</label>
      <textarea id="cutDetails" placeholder="Ù…Ø«Ø§Ù„: Ù‚Øµ Ø®Ø§Ø±Ø¬ÙŠ + Ø­ÙØ± Ø´Ø¹Ø§Ø± + ÙØªØ­Ø§Øª Ù…Ø³ÙƒØ© Ù…Ø®ÙÙŠØ©..."></textarea>

      <label>Ù‚ÙŠØ§Ø³Ø§Øª ÙŠØ¯ÙˆÙŠØ© (ÙŠÙƒØªØ¨Ù‡Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„)</label>
      <textarea id="manualMeasurements" placeholder="Ù…Ø«Ø§Ù„: ÙØªØ­Ø© Ø§Ù„Ø¨Ø§Ø¨ 2200Ã—1000 / Ù…Ø³Ø§ÙØ© Ø§Ù„Ø¬Ø§Ù… 60 / ÙÙˆÙ‚ 30 / ØªØ­Øª 20 ..."></textarea>

      <label>Ø±ÙØ¹ Ù…Ù„Ù (DXF / PDF / ØµÙˆØ±Ø©)</label>
      <input type="file" id="uploadFile" accept=".dxf,.pdf,image/*" />

      <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</label>
      <textarea id="notes" placeholder="Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª..."></textarea>

      <button class="btn btn-green" onclick="sendOrderToAdmin()">
        Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù„Ù„Ø£Ø¯Ù…Ù†
      </button>

      <div class="hint">
        âš ï¸ Ø­Ø§Ù„ÙŠØ§Ù‹ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ ØªØ¬Ø±ÙŠØ¨ÙŠ (Ø¨Ø¯ÙˆÙ† Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª).<br>
        Ø¨Ø¹Ø¯ÙŠÙ† Ù†Ø±Ø¨Ø·Ù‡ Ø¨Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª.
      </div>
    </div>

  </div>

  <script>
    // =========================
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ (ØªØ¬Ø±ÙŠØ¨ÙŠØ©)
    // =========================
    const clientData = JSON.parse(localStorage.getItem("loggedClient") || "{}");

    // Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© ÙŠØ¸Ù‡Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠ
    const companyName = clientData.company || "Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";

    document.getElementById("welcomeText").innerText = "Ù…Ø±Ø­Ø¨Ø§Ù‹: " + companyName;

    // =========================
    // ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬
    // =========================
    function logout(){
      localStorage.removeItem("loggedClient");
      window.location.href = "index.html";
    }

    // =========================
    // Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ (ØªØ¬Ø±ÙŠØ¨ÙŠ)
    // =========================
    function changeStatus(){
      const val = document.getElementById("statusSelect").value;
      const badge = document.getElementById("orderStatusBadge");

      if(val === "done"){
        badge.className = "badge badge-done";
        badge.innerText = "âœ… Ø¬Ø§Ù‡Ø² Ø§Ù„Ø·Ù„Ø¨";
      }else{
        badge.className = "badge badge-wip";
        badge.innerText = "â³ Ù‚ÙŠØ¯ Ø§Ù„ØªØ´ØºÙŠÙ„";
      }
    }

    // =========================
    // Ø´ÙŠØªØ§Øª Ø§Ù„Ù…ÙˆØ±Ø¯ (Ù…ØªØ¹Ø¯Ø¯Ø©)
    // =========================
    function addSheetRow(){
      const container = document.getElementById("sheetsContainer");

      const row = document.createElement("div");
      row.className = "sheetRow";

      row.innerHTML = `
        <div class="sheetRowHeader">
          <div style="font-weight:bold;">ØªÙØ§ØµÙŠÙ„ Ø´ÙŠØª Ø¬Ø¯ÙŠØ¯</div>
          <button class="small-btn small-red" onclick="this.closest('.sheetRow').remove()">ğŸ—‘ Ø­Ø°Ù</button>
        </div>

        <label>Ù‚ÙŠØ§Ø³ Ø§Ù„Ø´ÙŠØª</label>
        <select class="sheetSizeSelect" onchange="toggleCustomSize(this)">
          <option value="">Ø§Ø®ØªØ± Ù‚ÙŠØ§Ø³ Ø¬Ø§Ù‡Ø²</option>
          <option value="244Ã—122">244Ã—122</option>
          <option value="300Ã—150">300Ã—150</option>
          <option value="400Ã—200">400Ã—200</option>
          <option value="custom">Ù‚ÙŠØ§Ø³ Ø®Ø§Øµ (ÙŠØ¯ÙˆÙŠ)</option>
        </select>

        <input class="customSizeInput" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù‚ÙŠØ§Ø³ Ø§Ù„Ø®Ø§Øµ Ù…Ø«Ø§Ù„: 250Ã—125" style="display:none; margin-top:8px;" />

        <div class="row">
          <div class="col">
            <label>Ø§Ù„Ø³Ù…Ø§ÙƒØ© (mm)</label>
            <select class="sheetThickness">
              <option value="">Ø§Ø®ØªØ±</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="6">6</option>
              <option value="8">8</option>
              <option value="10">10</option>
            </select>
          </div>

          <div class="col">
            <label>Ø§Ù„ÙƒÙ…ÙŠØ©</label>
            <input class="sheetQty" type="number" min="1" placeholder="Ù…Ø«Ø§Ù„: 5" />
          </div>
        </div>
      `;

      container.appendChild(row);
    }

    function toggleCustomSize(selectEl){
      const row = selectEl.closest(".sheetRow");
      const customInput = row.querySelector(".customSizeInput");
      if(selectEl.value === "custom"){
        customInput.style.display = "block";
      }else{
        customInput.style.display = "none";
      }
    }

    function sendSheetsToSupplier(){
      const supplier = document.getElementById("supplierSelect").value;
      if(!supplier){
        alert("Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ±Ø¯ Ø£ÙˆÙ„Ø§Ù‹");
        return;
      }

      const rows = document.querySelectorAll(".sheetRow");
      if(rows.length === 0){
        alert("Ø£Ø¶Ù Ø´ÙŠØª ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");
        return;
      }

      let text = `Ø·Ù„Ø¨ Ø´Ø±Ø§Ø¡ Ø´ÙŠØªØ§Øª - ${companyName}\n\n`;

      let valid = true;
      rows.forEach((row, idx) => {
        const sizeSelect = row.querySelector(".sheetSizeSelect").value;
        const customSize = row.querySelector(".customSizeInput").value.trim();
        const thickness = row.querySelector(".sheetThickness").value;
        const qty = row.querySelector(".sheetQty").value;

        let sizeFinal = sizeSelect;
        if(sizeSelect === "custom"){
          sizeFinal = customSize;
        }

        if(!sizeFinal || !thickness || !qty){
          valid = false;
          return;
        }

        text += `(${idx+1}) Ù‚ÙŠØ§Ø³: ${sizeFinal} | Ø³Ù…Ø§ÙƒØ©: ${thickness}mm | ÙƒÙ…ÙŠØ©: ${qty}\n`;
      });

      if(!valid){
        alert("ØªØ£ÙƒØ¯ Ù…Ù† ØªØ¹Ø¨Ø¦Ø© Ù‚ÙŠØ§Ø³ Ø§Ù„Ø´ÙŠØª + Ø§Ù„Ø³Ù…Ø§ÙƒØ© + Ø§Ù„ÙƒÙ…ÙŠØ© Ù„ÙƒÙ„ Ø´ÙŠØª");
        return;
      }

      const wa = `https://wa.me/${supplier}?text=${encodeURIComponent(text)}`;
      window.open(wa, "_blank");
    }

    // =========================
    // Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ CNC Ù„Ù„Ø£Ø¯Ù…Ù† (ØªØ¬Ø±ÙŠØ¨ÙŠ)
    // =========================
    function sendOrderToAdmin(){
      const orderType = document.getElementById("orderType").value;
      const lineWidth = document.getElementById("lineWidth").value;
      const materialType = document.getElementById("materialType").value;
      const cutDetails = document.getElementById("cutDetails").value.trim();
      const manualMeasurements = document.getElementById("manualMeasurements").value.trim();
      const notes = document.getElementById("notes").value.trim();

      if(!orderType || !materialType){
        alert("ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨ ÙˆÙ†ÙˆØ¹ Ø§Ù„Ù…Ø§Ø¯Ø©");
        return;
      }

      if(!cutDetails && !manualMeasurements){
        alert("Ø§ÙƒØªØ¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‚Øµ/Ø§Ù„Ø­ÙØ± Ø£Ùˆ Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª Ø§Ù„ÙŠØ¯ÙˆÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");
        return;
      }

      // Ø­Ø§Ù„ÙŠØ§ Ø¨Ø¯ÙˆÙ† Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª - Ù…Ø¬Ø±Ø¯ ØªØ£ÙƒÙŠØ¯
      alert(
        "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ (ØªØ¬Ø±ÙŠØ¨ÙŠ) âœ…\n\n" +
        "Ø§Ù„Ø¹Ù…ÙŠÙ„: " + companyName + "\n" +
        "Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨: " + orderType + "\n" +
        "Ø§Ù„Ù…Ø§Ø¯Ø©: " + materialType + "\n" +
        "Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø·: " + (lineWidth || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯")
      );

      // ØªÙ‚Ø¯Ø± Ø¨Ø¹Ø¯ÙŠÙ† ØªØ±Ø¨Ø·Ù‡ Ø¨ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù„Ø£Ø¯Ù…Ù† Ø£Ùˆ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª
    }

    // Ø£ÙˆÙ„ Ù…Ø§ ØªÙØªØ­ Ø§Ù„ØµÙØ­Ø© Ù†Ø¶ÙŠÙ Ø´ÙŠØª ÙˆØ§Ø­Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠ
    addSheetRow();
  </script>

</body>
</html>
